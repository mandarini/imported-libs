{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.computesTemplateSourceFromComponent = exports.computesTemplateFromComponent = void 0;\nconst NgComponentAnalyzer_1 = require(\"./utils/NgComponentAnalyzer\");\nconst separateInputsOutputsAttributes = (ngComponentInputsOutputs, props = {}) => {\n  const inputs = ngComponentInputsOutputs.inputs.filter(i => i.templateName in props).map(i => i.templateName);\n  const outputs = ngComponentInputsOutputs.outputs.filter(o => o.templateName in props).map(o => o.templateName);\n  return {\n    inputs,\n    outputs,\n    otherProps: Object.keys(props).filter(k => ![...inputs, ...outputs].includes(k))\n  };\n};\n/**\n * Converts a component into a template with inputs/outputs present in initial props\n * @param component\n * @param initialProps\n * @param innerTemplate\n */\nconst computesTemplateFromComponent = (component, initialProps, innerTemplate = '') => {\n  const ngComponentMetadata = (0, NgComponentAnalyzer_1.getComponentDecoratorMetadata)(component);\n  const ngComponentInputsOutputs = (0, NgComponentAnalyzer_1.getComponentInputsOutputs)(component);\n  if (!ngComponentMetadata.selector) {\n    // Allow to add renderer component when NgComponent selector is undefined\n    return `<ng-container *ngComponentOutlet=\"storyComponent\"></ng-container>`;\n  }\n  const {\n    inputs: initialInputs,\n    outputs: initialOutputs\n  } = separateInputsOutputsAttributes(ngComponentInputsOutputs, initialProps);\n  const templateInputs = initialInputs.length > 0 ? ` ${initialInputs.map(i => `[${i}]=\"${i}\"`).join(' ')}` : '';\n  const templateOutputs = initialOutputs.length > 0 ? ` ${initialOutputs.map(i => `(${i})=\"${i}($event)\"`).join(' ')}` : '';\n  return buildTemplate(ngComponentMetadata.selector, innerTemplate, templateInputs, templateOutputs);\n};\nexports.computesTemplateFromComponent = computesTemplateFromComponent;\nconst createAngularInputProperty = ({\n  propertyName,\n  value,\n  argType\n}) => {\n  const {\n    name: type = null\n  } = typeof argType?.type === 'object' && argType?.type || {};\n  let templateValue = type === 'enum' && value;\n  const actualType = type === 'enum' && typeof value;\n  const requiresBrackets = ['object', 'any', 'boolean', 'enum', 'number'].includes(actualType);\n  if (typeof value === 'object') {\n    templateValue = propertyName;\n  }\n  return `${requiresBrackets ? '[' : ''}${propertyName}${requiresBrackets ? ']' : ''}=\"${templateValue}\"`;\n};\n/**\n * Converts a component into a template with inputs/outputs present in initial props\n * @param component\n * @param initialProps\n * @param innerTemplate\n */\nconst computesTemplateSourceFromComponent = (component, initialProps, argTypes) => {\n  const ngComponentMetadata = (0, NgComponentAnalyzer_1.getComponentDecoratorMetadata)(component);\n  if (!ngComponentMetadata) {\n    return null;\n  }\n  if (!ngComponentMetadata.selector) {\n    // Allow to add renderer component when NgComponent selector is undefined\n    return `<ng-container *ngComponentOutlet=\"${component.name}\"></ng-container>`;\n  }\n  const ngComponentInputsOutputs = (0, NgComponentAnalyzer_1.getComponentInputsOutputs)(component);\n  const {\n    inputs: initialInputs,\n    outputs: initialOutputs\n  } = separateInputsOutputsAttributes(ngComponentInputsOutputs, initialProps);\n  const templateInputs = initialInputs.length > 0 ? ` ${initialInputs.map(propertyName => createAngularInputProperty({\n    propertyName,\n    value: initialProps[propertyName],\n    argType: argTypes?.[propertyName]\n  })).join(' ')}` : '';\n  const templateOutputs = initialOutputs.length > 0 ? ` ${initialOutputs.map(i => `(${i})=\"${i}($event)\"`).join(' ')}` : '';\n  return buildTemplate(ngComponentMetadata.selector, '', templateInputs, templateOutputs);\n};\nexports.computesTemplateSourceFromComponent = computesTemplateSourceFromComponent;\nconst buildTemplate = (selector, innerTemplate, inputs, outputs) => {\n  // https://www.w3.org/TR/2011/WD-html-markup-20110113/syntax.html#syntax-elements\n  const voidElements = ['area', 'base', 'br', 'col', 'command', 'embed', 'hr', 'img', 'input', 'keygen', 'link', 'meta', 'param', 'source', 'track', 'wbr'];\n  const firstSelector = selector.split(',')[0];\n  const templateReplacers = [[/(^.*?)(?=[,])/, '$1'], [/(^\\..+)/, 'div$1'], [/(^\\[.+?])/, 'div$1'], [/([\\w[\\]]+)(\\s*,[\\w\\s-[\\],]+)+/, `$1`], [/#([\\w-]+)/, ` id=\"$1\"`], [/((\\.[\\w-]+)+)/, (_, c) => ` class=\"${c.split`.`.join` `.trim()}\"`], [/(\\[.+?])/g, (_, a) => ` ${a.slice(1, -1)}`], [/([\\S]+)(.*)/, (template, elementSelector) => {\n    return voidElements.some(element => elementSelector === element) ? template.replace(/([\\S]+)(.*)/, `<$1$2${inputs}${outputs} />`) : template.replace(/([\\S]+)(.*)/, `<$1$2${inputs}${outputs}>${innerTemplate}</$1>`);\n  }]];\n  return templateReplacers.reduce((prevSelector, [searchValue, replacer]) => prevSelector.replace(searchValue, replacer), firstSelector);\n};","map":{"version":3,"names":["Object","defineProperty","exports","value","computesTemplateSourceFromComponent","computesTemplateFromComponent","NgComponentAnalyzer_1","require","separateInputsOutputsAttributes","ngComponentInputsOutputs","props","inputs","filter","i","templateName","map","outputs","o","otherProps","keys","k","includes","component","initialProps","innerTemplate","ngComponentMetadata","getComponentDecoratorMetadata","getComponentInputsOutputs","selector","initialInputs","initialOutputs","templateInputs","length","join","templateOutputs","buildTemplate","createAngularInputProperty","propertyName","argType","name","type","templateValue","actualType","requiresBrackets","argTypes","voidElements","firstSelector","split","templateReplacers","_","c","trim","a","slice","template","elementSelector","some","element","replace","reduce","prevSelector","searchValue","replacer"],"sources":["/Users/katerina/Projects/nrwl/test_nx_workspaces/imported-libs/node_modules/@storybook/angular/dist/client/angular-beta/ComputesTemplateFromComponent.js"],"sourcesContent":["\"use strict\";\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.computesTemplateSourceFromComponent = exports.computesTemplateFromComponent = void 0;\nconst NgComponentAnalyzer_1 = require(\"./utils/NgComponentAnalyzer\");\nconst separateInputsOutputsAttributes = (ngComponentInputsOutputs, props = {}) => {\n    const inputs = ngComponentInputsOutputs.inputs\n        .filter((i) => i.templateName in props)\n        .map((i) => i.templateName);\n    const outputs = ngComponentInputsOutputs.outputs\n        .filter((o) => o.templateName in props)\n        .map((o) => o.templateName);\n    return {\n        inputs,\n        outputs,\n        otherProps: Object.keys(props).filter((k) => ![...inputs, ...outputs].includes(k)),\n    };\n};\n/**\n * Converts a component into a template with inputs/outputs present in initial props\n * @param component\n * @param initialProps\n * @param innerTemplate\n */\nconst computesTemplateFromComponent = (component, initialProps, innerTemplate = '') => {\n    const ngComponentMetadata = (0, NgComponentAnalyzer_1.getComponentDecoratorMetadata)(component);\n    const ngComponentInputsOutputs = (0, NgComponentAnalyzer_1.getComponentInputsOutputs)(component);\n    if (!ngComponentMetadata.selector) {\n        // Allow to add renderer component when NgComponent selector is undefined\n        return `<ng-container *ngComponentOutlet=\"storyComponent\"></ng-container>`;\n    }\n    const { inputs: initialInputs, outputs: initialOutputs } = separateInputsOutputsAttributes(ngComponentInputsOutputs, initialProps);\n    const templateInputs = initialInputs.length > 0 ? ` ${initialInputs.map((i) => `[${i}]=\"${i}\"`).join(' ')}` : '';\n    const templateOutputs = initialOutputs.length > 0\n        ? ` ${initialOutputs.map((i) => `(${i})=\"${i}($event)\"`).join(' ')}`\n        : '';\n    return buildTemplate(ngComponentMetadata.selector, innerTemplate, templateInputs, templateOutputs);\n};\nexports.computesTemplateFromComponent = computesTemplateFromComponent;\nconst createAngularInputProperty = ({ propertyName, value, argType, }) => {\n    const { name: type = null } = (typeof argType?.type === 'object' && argType?.type) || {};\n    let templateValue = type === 'enum' && value;\n    const actualType = type === 'enum' && typeof value;\n    const requiresBrackets = ['object', 'any', 'boolean', 'enum', 'number'].includes(actualType);\n    if (typeof value === 'object') {\n        templateValue = propertyName;\n    }\n    return `${requiresBrackets ? '[' : ''}${propertyName}${requiresBrackets ? ']' : ''}=\"${templateValue}\"`;\n};\n/**\n * Converts a component into a template with inputs/outputs present in initial props\n * @param component\n * @param initialProps\n * @param innerTemplate\n */\nconst computesTemplateSourceFromComponent = (component, initialProps, argTypes) => {\n    const ngComponentMetadata = (0, NgComponentAnalyzer_1.getComponentDecoratorMetadata)(component);\n    if (!ngComponentMetadata) {\n        return null;\n    }\n    if (!ngComponentMetadata.selector) {\n        // Allow to add renderer component when NgComponent selector is undefined\n        return `<ng-container *ngComponentOutlet=\"${component.name}\"></ng-container>`;\n    }\n    const ngComponentInputsOutputs = (0, NgComponentAnalyzer_1.getComponentInputsOutputs)(component);\n    const { inputs: initialInputs, outputs: initialOutputs } = separateInputsOutputsAttributes(ngComponentInputsOutputs, initialProps);\n    const templateInputs = initialInputs.length > 0\n        ? ` ${initialInputs\n            .map((propertyName) => createAngularInputProperty({\n            propertyName,\n            value: initialProps[propertyName],\n            argType: argTypes?.[propertyName],\n        }))\n            .join(' ')}`\n        : '';\n    const templateOutputs = initialOutputs.length > 0\n        ? ` ${initialOutputs.map((i) => `(${i})=\"${i}($event)\"`).join(' ')}`\n        : '';\n    return buildTemplate(ngComponentMetadata.selector, '', templateInputs, templateOutputs);\n};\nexports.computesTemplateSourceFromComponent = computesTemplateSourceFromComponent;\nconst buildTemplate = (selector, innerTemplate, inputs, outputs) => {\n    // https://www.w3.org/TR/2011/WD-html-markup-20110113/syntax.html#syntax-elements\n    const voidElements = [\n        'area',\n        'base',\n        'br',\n        'col',\n        'command',\n        'embed',\n        'hr',\n        'img',\n        'input',\n        'keygen',\n        'link',\n        'meta',\n        'param',\n        'source',\n        'track',\n        'wbr',\n    ];\n    const firstSelector = selector.split(',')[0];\n    const templateReplacers = [\n        [/(^.*?)(?=[,])/, '$1'],\n        [/(^\\..+)/, 'div$1'],\n        [/(^\\[.+?])/, 'div$1'],\n        [/([\\w[\\]]+)(\\s*,[\\w\\s-[\\],]+)+/, `$1`],\n        [/#([\\w-]+)/, ` id=\"$1\"`],\n        [/((\\.[\\w-]+)+)/, (_, c) => ` class=\"${c.split `.`.join ` `.trim()}\"`],\n        [/(\\[.+?])/g, (_, a) => ` ${a.slice(1, -1)}`],\n        [\n            /([\\S]+)(.*)/,\n            (template, elementSelector) => {\n                return voidElements.some((element) => elementSelector === element)\n                    ? template.replace(/([\\S]+)(.*)/, `<$1$2${inputs}${outputs} />`)\n                    : template.replace(/([\\S]+)(.*)/, `<$1$2${inputs}${outputs}>${innerTemplate}</$1>`);\n            },\n        ],\n    ];\n    return templateReplacers.reduce((prevSelector, [searchValue, replacer]) => prevSelector.replace(searchValue, replacer), firstSelector);\n};\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}